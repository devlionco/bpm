define(["jquery","jqueryui"],function(e){function t(e){var t=e.substr(6,4)+"-"+e.substr(3,2)+"-"+e.substr(0,2),i=new Date(t);return i.setHours(23,0,0),i}function i(){var e=new Date;return e.setHours(23,0,0),e}function a(o,p,u){var g="<div><p>"+p+'</p><div><input type="text" class="form-control" id="datepicker" disabled="disabled" style="display:inline; width:230px"><img id="datepickerTrigger" class="icon smallicon" style="margin:0 5px 0 0" src="https://my.bpm-music.com/local/teachernotice/js/theme/calender.svg"></div><p id="noDateInput" style="display:none; margin:0 0 1rem 0"><i class="fa fa-exclamation-triangle fa-lg" aria-hidden="true" style="color:#ee3e61; margin-left:5px;" />לא הוזן תאריך</p></div>',m={autoOpen:!1,draggable:!1,modal:!0,title:o,closeOnEscape:!1,classes:{"ui-dialog":"ui-dialog ui-corner-all ui-widget ui-widget-content ui-front ui-dialog-buttons ui-resizable tn-dialog"},open:function(){e(this).html(g),r()},buttons:[{text:"אשר",click:function(){var o=e("#datepicker").val();if(""!==o){e(this).dialog("close");var r=Math.round(t(o).getTime()/1e3);if(e.post(l,{courseId:n.id,assignmentDate:r,assignmentType:u}),u==c.exam.type&&"1"!=d){var p=Math.round(i().getTime()/1e3);if(p>=r){var g=a(c.project.title,c.project.text,c.project.type);s.dialog(g).dialog("open"),e(".ui-dialog-titlebar-close").hide()}}}else e("#noDateInput").show()}}]};return m}function o(t){switch(d=t){case"1":case"2":s.dialog(p).dialog("open"),e(".ui-dialog-titlebar-close").hide();break;case"3":case"4":var i=a(c.project.title,c.project.text,c.project.type);s.dialog(i).dialog("open"),e(".ui-dialog-titlebar-close").hide()}}var n=function(){for(var e={},t=window.location.search.substring(1),i=t.split("&"),a=0;a<i.length;a++){var o=i[a].split("=");if("undefined"==typeof e[o[0]])e[o[0]]=decodeURIComponent(o[1]);else if("string"==typeof e[o[0]]){var n=[e[o[0]],decodeURIComponent(o[1])];e[o[0]]=n}else e[o[0]].push(decodeURIComponent(o[1]))}return e}(),r=function(){e("#datepicker").datepicker({constrainInput:!0,draggable:!1,resizable:!1,closeText:"סגור",prevText:"&#x3C;הקודם",nextText:"הבא&#x3E;",currentText:"היום",monthNames:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],monthNamesShort:["ינו","פבר","מרץ","אפר","מאי","יוני","יולי","אוג","ספט","אוק","נוב","דצמ"],dayNames:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],dayNamesShort:["א'","ב'","ג'","ד'","ה'","ו'","שבת"],dayNamesMin:["א'","ב'","ג'","ד'","ה'","ו'","שבת"],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!0,showMonthAfterYear:!1,yearSuffix:""}),e("#datepickerTrigger").click(function(){e("#datepicker").datepicker("show")})},l="https://my.bpm-music.com/local/teachernotice/add_record.php",s=e('<div id="dialogElemenet"/>'),d="5",c={exam:{title:"מבחן אמצע",text:"נא להזין תאריך בו יתבצע מבחן אמצע:",type:"1"},project:{title:"פרויקט אמצע",text:"המערכת זיהתה כי קיים פרויקט אמצע בקורס זה, נא להזין תאריך הגשה:",type:"3"}},p={autoOpen:!1,draggable:!1,modal:!0,title:"מבחן אמצע",closeOnEscape:!1,classes:{"ui-dialog":"ui-dialog ui-corner-all ui-widget ui-widget-content ui-front ui-dialog-buttons ui-resizable tn-dialog"},open:function(){e(this).html("האם התבצע היום מבחן אמצע?")},buttons:[{text:"כן",click:function(){if(e(this).dialog("close"),examDate=Math.round(i().getTime()/1e3),e.post(l,{courseId:n.id,assignmentDate:examDate,assignmentType:"1"}),"1"!=d){var t=a(c.project.title,c.project.text,c.project.type);s.dialog(t).dialog("open"),e(".ui-dialog-titlebar-close").hide()}}},{text:"לא",click:function(){e(this).dialog("close");var t=a(c.exam.title,c.exam.text,c.exam.type);e(this).dialog(t).dialog("open"),e(".ui-dialog-titlebar-close").hide()}}]};return{generatePopup:o}});